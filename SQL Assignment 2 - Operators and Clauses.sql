/* 1) What is the Highest Number of copies sold by a Package? */
SELECT MAX(SOLD) AS HIGHESTNOOFCOPIES
FROM SOFTWARE;

/* 2) Display lowest course Fee. */
SELECT MIN(COURSEFEE) AS LOWESTCOURSEFEE
FROM STUDIES;

/* 3) How old is the Oldest Male Programmer. */
SELECT MAX(DATEDIFF(YEAR, DOB, GETDATE())) AS OLDESTMALEPROGRAMMER
FROM PROGRAMMER
WHERE GENDER = 'M';

/* 4) What is the AVG age of Female Programmers? */
SELECT AVG(DATEDIFF(YEAR, DOB, GETDATE())) AS AVERAGEFEMALEAGE
FROM PROGRAMMER
WHERE GENDER = 'F';

/* 5) Calculate the Experience in Years for each Programmer and Display with
their names in Descending order */
SELECT PNAME, DATEDIFF(YEAR, DOJ, GETDATE()) AS EXPERIENCE
FROM PROGRAMMER
ORDER BY PNAME DESC;

/* 6) How many programmers have done the PGDCA Course? */
SELECT COUNT(COURSE) AS NOOFPROGRAMMERS
FROM STUDIES
WHERE COURSE = 'PGDCA';

/* 7) How much revenue has been earned thru sales of Packages Developed in C. */
SELECT (SCOST*SOLD) AS REVENUE
FROM SOFTWARE
WHERE DEVELOPIN = 'C';

SELECT SUM(SCOST*SOLD) AS REVENUE
FROM SOFTWARE
WHERE DEVELOPIN = 'C';

/* 8) How many Programmers Studied at Sabhari? */
SELECT COUNT(PNAME) AS NOOFPROGRAMMERS
FROM STUDIES
WHERE INSTITUTE = 'SABHARI';

/* 9) How many Packages Developed in DBASE? */
SELECT COUNT(TITLE) AS NOOFPACKAGESINDBASE
FROM SOFTWARE
WHERE DEVELOPIN = 'DBASE';

10.	SELECT COUNT(PNAME) AS NOOFPROGRAMMERS
FROM STUDIES
WHERE INSTITUTE = ‘PRAGATHI’;

11.	SELECT COUNT(PNAME) AS NOOFPROGRAMMERS
FROM SOFTWARE
WHERE COURSEFEE BETWEEN 5000 AND 10000;

12.	SELECT COUNT(PNAME) AS NOOFPROGRAMMERS
FROM PROGRAMMER
WHERE PROF1 IN (‘COBOL’, ‘PASCAL’) OR PROF2 IN (‘COBOL’, ‘PASCAL’);

13.	SELECT COUNT(GENDER) AS NOOFFEMALES
FROM PROGRAMMER
WHERE GENDER = ‘F’;


14.	SELECT AVG(SALARY) AS AVERAGESALARY
FROM PROGRAMMER;

15.	SELECT COUNT(PNAME) AS NOOFPEOPLE
FROM PROGRAMMER
WHERE SALARY BETWEEN 2000 AND 4000;

16.	SELECT SUM(SCOST) AS TOTALCOST, DEVELOPIN
FROM SOFTWARE
GROUP BY DEVELOPIN;

17.	SELECT y.*
FROM STUDIES x, SOFTWARE y, PROGRAMMER z
WHERE x.PNAME = y.PNAME AND y.PNAME = z.PNAME AND x.INSTITUTE = ‘SABHARI’ AND z.GENDER = ‘MALE’;

18.	SELECT PNAME
FROM PROGRAMMER
WHERE DOB = (SELECT MIN(DOB) FROM PROGRAMMER WHERE YEAR(DOJ)=’1992’ AND GENDER= ‘F’);

19.	SELECT PNAME
FROM PROGRAMMER
WHERE DOB = (SELECT MAX(DOB) FROM PROGRAMMER WHERE YEAR(DOB) = ‘1965’ AND GENDER = ‘M’);

20.	SELECT DEVELOPIN
FROM SOFTWARE
WHERE SCOST= (SELECT MIN(SCOST) FROM SOFTWARE);

21.	SELECT PNAME
FROM PROGRAMMER
WHERE GENDER = ‘F’ AND SALARY > 3000 AND PROF1 NOT IN (‘C’,’C++’, ‘ORACLE’, ‘DBASE’) AND PROF2 NOT IN (‘C’, ‘C++’, ‘ORACLE, ‘DBASE’)

22.	SELECT PNAME
FROM PROGRAMMER
WHERE DOB = (SELECT MAX(DOB) FROM PROGRAMMER WHERE PROF1 = ‘DBASE’ OR PROF2= ‘DBASE’);

23.	 CREATE VIEW LANGUAGE AS
SELECT PROF1, PNAME
FROM PROGRAMMER
UNION
SELECT PROF2, PNAME
FROM PROGRAMMER

SELECT COUNT(PNAME), PROF1
FROM LANGUAGE
GROUP BY PROF1
HAVING COUNT(PNAME) = 1;

24.	SELECT PNAME 
FROM PROGRAMMER
WHERE DOJ = (SELECT MIN(DOJ) FROM PROGRAMMER WHERE PROF1=’PASCAL’ OR PROF2=’PASCAL’) AND GENDER = ‘M’;

25.	SELECT PNAME
FROM PROGRAMMER
WHERE DOJ = (SELECT MAX(DOJ) FROM PROGRAMMER);

26.	SELECT COUNT(TITLE) AS NOOFPACKAGES, DEVELOPIN
FROM SOFTWARE
WHERE DCOST < 1000
GROUP BY DEVELOPIN;

27.	SELECT MAX(SALARY) AS HIGHESTSALARY, MIN(SALARY) AS LOWESTSALARY, AVG(SALARY) AS AVERAGESALARY
FROM PROGRAMMER
WHERE SALARY > 2000;

CREATE TABLE STUDIES 
    (PNAME VARCHAR(20) PRIMARY KEY,
    INSTITUTE VARCHAR(20),
    COURSE VARCHAR(20),
    COURSEFEE INT
    );

INSERT INTO STUDIES VALUES ('ANAND', 'SABHARI', 'PGDCA', 4500),
                            ('ALTAF', 'COIT', 'DCA', 7200),
                            ('JULIANA', 'BDPS', 'MCA', 22000),
                            ('KAMALA', 'PRAGATHI', 'DCA', 5000),
                            ('MARY', 'SABHARI', 'PGDCA', 4500),
                            ('NELSON', 'PRAGATHI', 'DAP', 6200),
                            ('PATRICK', 'PRAGATHI', 'DCAP', 5200),
                            ('QADIR', 'APPLE', 'HDCA', 14000),
                            ('RAMESH', 'SABHARI', 'PGDCA', 4500),
                            ('REBECCA', 'BRILLIANT', 'DCAP', 11000),
                            ('REMITHA', 'BDPS', 'DCS', 6000),
                            ('REVATHI', 'SABHARI', 'DAP', 5000),
                            ('VIJAYA', 'BDPS', 'DCA', 48000);

CREATE TABLE SOFTWARE
    (PNAME VARCHAR(20),
    TITLE VARCHAR(20),
    DEVELOPIN VARCHAR(20),
    SCOST INT,
    DCOST INT,
    SOLD INT
    );

INSERT INTO SOFTWARE VALUES ('MARY', 'README', 'CPP', 300, 1200, 84),
                            ('ANAND', 'PARACHUTES', 'BASIC', 399.95, 6000, 43),
                            ('ANAND', 'VIDEO TITLING', 'PASCAL', 7500, 16000, 9),
                            ('JULIANA', 'INVENTORY', 'COBOL', 3000, 3500, 0),
                            ('KAMALA', 'PAYROLL PKG.', 'DBASE', 9000, 20000, 7),
                            ('MARY', 'FINANCIAL ACCT.', 'ORACLE', 18000, 85000, 4),
                            ('MARY', 'CODE GENERATOR', 'C', 4500, 20000, 23),
                            ('PATTRICK', 'README', 'CPP', 300, 1200, 84),
                            ('QADIR', 'BOMBS AWAY', 'ASSEMBLY', 750, 3000, 11),
                            ('QADIR', 'VACCINES', 'C', 1900, 3100, 21),
                            ('RAMESH', 'HOTEL MGMT.', 'DBASE', 13000, 35000, 4),
                            ('RAMESH', 'DEAD LEE', 'PASCAL', 599.95, 4500, 73),
                            ('REMITHA', 'PC UTILITIES', 'C', 725, 5000, 51),
                            ('REMITHA', 'TSR HELP PKG.', 'ASSEMBLY', 2500, 6000, 7),
                            ('REVATHI', 'HOSPITAL MGMT.', 'PASCAL', 1100, 75000, 2),
                            ('VIJAYA', 'TSR EDITOR', 'C', 900, 700, 6);

CREATE TABLE PROGRAMMER 
    (PNAME VARCHAR(20),
    DOB VARCHAR(20),
    DOJ VARCHAR(20),
    GENDER CHAR(1),
    PROF1 VARCHAR(20),
    PROF2 VARCHAR(20),
    SALARY INT
    );

INSERT INTO PROGRAMMER VALUES ('ANAND', '1966-04-12', '1992-04-21', 'M', 'PASCAL', 'BASIC', 3200),
                                ('ALTAF', '1964-07-02', '1990-11-13', 'M', 'CLIPPER', 'COBOL', 2800),
                                ('JULIANA', '1960-01-31','1990-04-21', 'F', 'COBOL', 'DBASE', 3000),
                                ('KAMALA', '1968-10-30', '1992-01-02', 'F', 'C', 'DBASE', 2900),
                                ('MARY', '1970-06-24', '1991-02-01', 'F', 'CPP', 'ORACLE', 4500),
                                ('NELSON', '1985-09-11', '1989-10-11', 'M', 'COBOL', 'DBASE', 2500),
                                ('PATTRICK', '1965-11-10', '1990-04-21', 'M', 'PASCAL', 'CLIPPER', 2800),
                                ('QADIR', '1965-08-31', '1991-04-21', 'M', 'ASSEMBLY', 'C', 3000),
                                ('RAMESH', '1967-05-03', '1991-02-28', 'M', 'PASCAL', 'DBASE', 3200),
                                ('REBECCA', '1967-01-01', '1990-12-01', 'F', 'BASIC', 'COBOL', 2500),
                                ('REMITHA', '1970-04-19', '1993-04-20', 'F', 'C', 'ASSEMBLY', 3600),
                                ('REVATHI', '1969-12-02', '1992-01-02', 'F', 'PASCAL', 'BASIC', 3700),
                                ('VIJAYA', '1965-12-14', '1992-05-02', 'F', 'FOXPRO', 'C', 3500);